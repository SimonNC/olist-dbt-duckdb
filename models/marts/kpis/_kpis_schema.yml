version: 2

models:
  - name: mrt_kpi_daily_orders
    description: |
      Daily **order-level KPIs**.
      **Grain:** one row per `order_date`.

      Provides a high-level view of daily business activity and is typically
      used for executive dashboards and trend analysis.

    meta:
      owner: "Simon"
      domain: "kpis"
      maturity: "stable"

    columns:
      - name: order_date
        description: "Calendar date of the order (derived from order purchase timestamp)."
        tests: [not_null, unique]

      - name: orders_count
        description: "Total number of orders placed on the given day."
        tests: [not_null]

      - name: revenue_total
        description: "Total revenue generated on the given day."
        tests: [not_null]

  - name: mrt_kpi_daily_status
    description: |
      Daily **order status KPIs**.
      **Grain:** one row per (`order_date`, `order_status`).

      Used to analyze the distribution and evolution of order lifecycle
      statuses over time.

    meta:
      owner: "Simon"
      domain: "kpis"
      maturity: "stable"

    columns:
      - name: order_date
        description: "Calendar date of the order."
        tests: [not_null]

      - name: order_status
        description: "Lifecycle status of the order."
        tests: [not_null]

      - name: orders_count
        description: "Number of orders with the given status on the given day."
        tests: [not_null]

      - name: orders_share
        description: "Share of orders for the given status relative to total daily orders."
        tests: [not_null]

  - name: mrt_kpi_revenue_by_state_daily
    description: |
      Daily **revenue and order volume by customer state**.
      **Grain:** one row per (`order_date`, `customer_state`).

      Supports geographic analysis of business performance and regional comparisons.

    meta:
      owner: "Simon"
      domain: "kpis"
      maturity: "stable"

    columns:
      - name: order_date
        description: "Calendar date of the order."
        tests: [not_null]

      - name: customer_state
        description: "State associated with the customer's delivery address."
        tests: [not_null]

      - name: orders_count
        description: "Number of orders placed by customers in the given state on the given day."
        tests: [not_null]

      - name: revenue_total
        description: "Total revenue generated by customers in the given state on the given day."
        tests: [not_null]

  - name: mrt_kpi_daily_customers
    description: |
      Daily **customer acquisition and retention KPIs**.
      **Grain:** one row per `order_date`.

      Distinguishes between new and repeat customers using the
      business-level identifier (`customer_unique_id`).

    meta:
      owner: "Simon"
      domain: "kpis"
      maturity: "stable"

    columns:
      - name: order_date
        description: "Calendar date of customer activity."
        tests: [not_null, unique]

      - name: customers_total
        description: "Total number of distinct customers active on the given day."
        tests: [not_null]

      - name: new_customers
        description: "Number of customers placing their first-ever order on the given day."
        tests: [not_null]

      - name: repeat_customers
        description: "Number of customers who had placed at least one prior order."
        tests: [not_null]

      - name: repeat_rate
        description: "Ratio of repeat customers to total customers for the given day."
        tests: [not_null]
